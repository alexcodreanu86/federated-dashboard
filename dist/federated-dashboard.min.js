!function(a){"use strict";window.namespace=function(b,c){for(var d,e=window,f=b.split(".");d=f.shift();)e[d]=e[d]||{},e=e[d];a.extend(e,c)}}(window._),function(){namespace("Dashboard"),Dashboard.Controller=function(){function a(){}return a.initialize=function(){return this.bindMenuButton(),this.bindSidenavButtons(),Dashboard.WidgetManager.generateWrappers(),this.bindClosingWidgets()},a.bindClosingWidgets=function(){return $(document).on("click",".close-widget",function(a){return function(b){return a.getWidgetToBeClosed(b)}}(this))},a.bindSidenavButtons=function(){return $("[data-id=pictures-widget]").click(function(a){return function(){return a.checkWidget("pictures")}}(this)),$("[data-id=weather-widget]").click(function(a){return function(){return a.checkWidget("weather")}}(this)),$("[data-id=stock-widget]").click(function(a){return function(){return a.checkWidget("stock")}}(this)),$("[data-id=twitter-widget]").click(function(a){return function(){return a.checkWidget("twitter")}}(this))},a.unbind=function(){return $("[data-id=pictures-widget]").unbind("click"),$("[data-id=weather-widget]").unbind("click"),$("[data-id=stock-widget]").unbind("click"),$("[data-id=twitter-widget]").unbind("click")},a.bindMenuButton=function(){return $("[data-id=menu-button]").click(function(a){return function(){return a.toggleSidenav()}}(this))},a.rebind=function(){return this.unbind(),this.bindSidenavButtons()},a.getWidgetToBeClosed=function(a){var b;return b=$(a.currentTarget).attr("data-name"),this.closeWidget(b)},a.checkWidget=function(a){var b;return b=Dashboard.WidgetManager.wrappers[a],b.isActive?void 0:this.setupWidget(b)},a.setupWidget=function(a){var b;return b=Dashboard.Display.generateAvailableSlotFor(a),b?(Dashboard.Display.setSidenavButtonActive(a),a.setupWidgetIn(b),b=Dashboard.WidgetManager.getContainerAndNameOf(a),Dashboard.Display.addButtonToContainer(b)):void 0},a.closeWidget=function(a){var b;return b=Dashboard.WidgetManager.wrappers[a],Dashboard.Display.emptySlotsInColumn(b.numberOfSlots,b.containerColumn),Dashboard.Display.setSidenavButtonInactive(b),b.closeWidget()},a.toggleSidenav=function(){return Dashboard.Display.isSidenavDisplayed()?this.removeSidenav():this.showSidenav(),this.rebind()},a.removeSidenav=function(){return Dashboard.Display.removeSidenav(),Dashboard.Display.removeClosingButtons()},a.showSidenav=function(){var a;return a=Dashboard.WidgetManager.getSidenavButtons(),Dashboard.Display.showSidenav(a),this.enterEditMode()},a.enterEditMode=function(){var a;return a=Dashboard.WidgetManager.getActiveWidgetsData(),Dashboard.Display.addClosingButtonsFor(a)},a}()}.call(this),function(){var a;namespace("Dashboard"),a=3,Dashboard.Display=function(){function b(){}return b.takenSlots={col0:0,col1:0,col2:0},b.emptySlotsInColumn=function(a,b){return this.takenSlots[b]-=a},b.populateWidget=function(a){return $("[data-id=widget-display]").html(a)},b.showSidenav=function(a){var b;return b=new EJS({url:"scripts/dashboard/templates/sidenavContent.ejs"}).render({buttons:a}),$("[data-id=side-nav]").html(b)},b.setSidenavButtonActive=function(a){var b;return b="[data-id="+a.name+"-widget]",$(b).parent().removeClass("inactive"),$(b).parent().addClass("active")},b.setSidenavButtonInactive=function(a){var b;return b="[data-id="+a.name+"-widget]",$(b).parent().removeClass("active"),$(b).parent().addClass("inactive")},b.removeSidenav=function(){return $("[data-id=side-nav]").empty()},b.isSidenavDisplayed=function(){return $("[data-id=side-nav]").html().length>0},b.generateAvailableSlotFor=function(a){var b,c,d;return c=""+a.name+"-slot",d=a.numberOfSlots,b=this.getAvailableColumn(d),b?(this.addWidgetContainerToColumn(c,b,d),{containerName:"[data-id="+c+"]",containerColumn:b}):void 0},b.addWidgetContainerToColumn=function(a,b,c){return $("[data-id="+b+"]").append("<div class='widget' data-id='"+a+"'></div>"),this.takenSlots[b]+=c},b.getAvailableColumn=function(b){var c;return c=_.map(this.takenSlots,function(c,d){return a>=c+b?d:void 0}),_.find(c,function(a){return a})},b.addClosingButtonsFor=function(a){return _.each(a,this.addButtonToContainer)},b.addButtonToContainer=function(a){var b;return b="<button class='close-widget' data-name="+a.name+">X</button>",$(a.container).prepend(b)},b.removeClosingButtons=function(){return $(".close-widget").remove()},b}()}.call(this),function(){namespace("Dashboard"),Dashboard.Draggable=function(){function a(){}return a.initialize=function(){return $("[data-id=widgets-menu] li").draggable({helper:"clone",start:function(a){return function(){return a.startedDragging(event)}}(this),stop:function(a){return function(){return a.stoppedDragging()}}(this)})},a.startedDragging=function(a){return console.log(a),console.log("started dragging")},a.stoppedDragging=function(){return console.log("stopped dragging")},a.dropProcessor=function(){return $(".widget-col").droppable({accept:"[data-id=widgets-menu] li",activeClass:"active-droppable",hoverClass:"hover-droppable",drop:function(a){return console.log($($(a.toElement.outerHTML)[0]).attr("data-id")),$(this).append("<h1>Hello</h1>")}})},a}()}.call(this),function(){namespace("Dashboard"),Dashboard.WidgetManager=function(){function a(){}return a.wrapWidget=function(a,b,c,d){return new Dashboard.WidgetWrapper({widget:a,name:b,numberOfSlots:c,apiKey:d})},a.generateWrappers=function(){return this.wrappers={pictures:this.wrapWidget(Pictures,"pictures",3,"a48194703ae0d0d1055d6ded6c4c9869"),weather:this.wrapWidget(Weather,"weather",1,"12ba191e2fec98ad"),twitter:this.wrapWidget(Twitter,"twitter",2,""),stock:this.wrapWidget(Stock,"stock",2,"")}},a.getActiveWidgets=function(){return _.filter(Dashboard.WidgetManager.wrappers,function(a){return a.isActive})},a.getSidenavButtons=function(){var a;return a=_.values(Dashboard.WidgetManager.wrappers),_.map(a,function(a){return a.widgetLogo()})},a.getActiveWidgetsData=function(){var a;return a=this.getActiveWidgets(),_.map(a,this.getContainerAndNameOf)},a.getContainerAndNameOf=function(a){return{container:a.containerName,name:a.name}},a}()}.call(this),function(){var a;namespace("Dashboard"),a="50",Dashboard.WidgetWrapper=function(){function b(a){this.widget=a.widget,this.widgetApiKey=a.apiKey,this.name=a.name,this.numberOfSlots=a.numberOfSlots}return b.prototype.isActive=!1,b.prototype.setupWidgetIn=function(a){return this.containerName=a.containerName,this.containerColumn=a.containerColumn,this.isActive=!0,this.widget.Controller.setupWidgetIn(this.containerName,this.widgetApiKey)},b.prototype.widgetLogo=function(){var b,c;return c=""+this.name+"-widget",b=this.widget.Display.generateLogo({dataId:c,width:a}),{html:b,isActive:this.isActive}},b.prototype.closeWidget=function(){return $(this.containerName).remove(),this.isActive=!1},b.prototype.addClosingButtonToContainer=function(){var a;return a=""+this.name+"-closing-button",$(this.containerName).prepend("<button data-id='"+a+"'>X</button>"),a},b}()}.call(this);