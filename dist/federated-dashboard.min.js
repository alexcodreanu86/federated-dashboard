!function(a){"use strict";window.namespace=function(b,c){for(var d,e=window,f=b.split(".");d=f.shift();)e[d]=e[d]||{},e=e[d];a.extend(e,c)}}(window._),function(){namespace("Dashboard"),Dashboard.Controller=function(){function a(){}return a.initialize=function(){return this.bindMenuButton(),Dashboard.Sidenav.Controller.bindButtons(),Dashboard.Widgets.Controller.initialize()},a.bindMenuButton=function(){return $("[data-id=menu-button]").click(function(a){return function(){return a.toggleSidenav()}}(this))},a.toggleSidenav=function(){return Dashboard.Display.isSidenavDisplayed()?this.removeSidenav():this.setupSidenav()},a.setupSidenav=function(){var a;return a=Dashboard.Widgets.Manager.getSidenavButtons(),Dashboard.Display.showSidenav(a),Dashboard.Sidenav.Controller.rebindButtons(),Dashboard.Widgets.Controller.enterEditMode()},a.removeSidenav=function(){return Dashboard.Display.removeSidenav(),Dashboard.Widgets.Controller.exitEditMode()},a}()}.call(this),function(){namespace("Dashboard"),Dashboard.Display=function(){function a(){}return a.showSidenav=function(a){var b;return b=new EJS({url:"scripts/dashboard/sidenav/sidenavContent.ejs"}).render({buttons:a}),$("[data-id=side-nav]").html(b)},a.removeSidenav=function(){return $("[data-id=side-nav]").empty()},a.isSidenavDisplayed=function(){return $("[data-id=side-nav]").html().length>0},a}()}.call(this),function(){namespace("Dashboard.Sidenav"),Dashboard.Sidenav.Controller=function(){function a(){}return a.bindButtons=function(){return $("[data-id=pictures-widget]").click(function(){return function(){return Dashboard.Widgets.Controller.checkWidget("pictures")}}(this)),$("[data-id=weather-widget]").click(function(){return function(){return Dashboard.Widgets.Controller.checkWidget("weather")}}(this)),$("[data-id=stock-widget]").click(function(){return function(){return Dashboard.Widgets.Controller.checkWidget("stock")}}(this)),$("[data-id=twitter-widget]").click(function(){return function(){return Dashboard.Widgets.Controller.checkWidget("twitter")}}(this))},a.unbind=function(){return $("[data-id=pictures-widget]").unbind("click"),$("[data-id=weather-widget]").unbind("click"),$("[data-id=stock-widget]").unbind("click"),$("[data-id=twitter-widget]").unbind("click")},a.rebindButtons=function(){return this.unbind(),this.bindButtons()},a}()}.call(this),function(){namespace("Dashboard.Sidenav"),Dashboard.Sidenav.Display=function(){function a(){}return a.setButtonActive=function(a){var b;return b="[data-id="+a.name+"-widget]",$(b).parent().removeClass("inactive"),$(b).parent().addClass("active")},a.setButtonInactive=function(a){var b;return b="[data-id="+a.name+"-widget]",$(b).parent().removeClass("active"),$(b).parent().addClass("inactive")},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.Controller=function(){function a(){}return a.initialize=function(){return Dashboard.Widgets.Manager.generateWrappers(),this.bindClosingWidgets()},a.checkWidget=function(a){var b;return b=Dashboard.Widgets.Manager.wrappers[a],b.isActive?void 0:this.setupWidget(b)},a.setupWidget=function(a){var b;return b=Dashboard.Widgets.Display.generateAvailableSlotFor(a),b?(Dashboard.Sidenav.Display.setButtonActive(a),a.setupWidgetIn(b),b=Dashboard.Widgets.Manager.getContainerAndNameOf(a),Dashboard.Widgets.Display.addButtonToContainer(b)):void 0},a.enterEditMode=function(){var a;return a=Dashboard.Widgets.Manager.getActiveWidgetsData(),Dashboard.Widgets.Display.addClosingButtonsFor(a),Dashboard.Widgets.Manager.showActiveForms()},a.exitEditMode=function(){return Dashboard.Widgets.Display.removeClosingButtons(),Dashboard.Widgets.Manager.hideActiveForms()},a.bindClosingWidgets=function(){return $(document).on("click",".close-widget",function(a){return function(b){return a.getWidgetToBeClosed(b)}}(this))},a.getWidgetToBeClosed=function(a){var b;return b=$(a.currentTarget).attr("data-name"),this.closeWidget(b)},a.closeWidget=function(a){var b;return b=Dashboard.Widgets.Manager.wrappers[a],Dashboard.Widgets.Display.emptySlotsInColumn(b.numberOfSlots,b.containerColumn),Dashboard.Sidenav.Display.setButtonInactive(b),b.deactivateWidget()},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.Display=function(){function a(){}var b;return b=3,a.takenSlots={col0:0,col1:0,col2:0},a.emptySlotsInColumn=function(a,b){return this.takenSlots[b]-=a},a.generateAvailableSlotFor=function(a){var b,c,d;return c=""+a.name+"-slot",d=a.numberOfSlots,b=this.getAvailableColumn(d),b?(this.addWidgetContainerToColumn(c,b,d),{containerName:"[data-id="+c+"]",containerColumn:b}):void 0},a.addWidgetContainerToColumn=function(a,b,c){return $("[data-id="+b+"]").append("<div class='widget' data-id='"+a+"'></div>"),this.takenSlots[b]+=c},a.getAvailableColumn=function(a){var c;return c=_.map(this.takenSlots,function(c,d){return b>=c+a?d:void 0}),_.find(c,function(a){return a})},a.addClosingButtonsFor=function(a){return _.each(a,this.addButtonToContainer)},a.addButtonToContainer=function(a){var b;return b="<button class='close-widget' data-name="+a.name+">X</button>",$(a.container).prepend(b)},a.removeClosingButtons=function(){return $(".close-widget").remove()},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.Manager=function(){function a(){}return a.wrapWidget=function(a,b,c,d){return new Dashboard.Widgets.Wrapper({widget:a,name:b,numberOfSlots:c,apiKey:d})},a.generateWrappers=function(){return this.wrappers={pictures:this.wrapWidget(Pictures,"pictures",3,"a48194703ae0d0d1055d6ded6c4c9869"),weather:this.wrapWidget(Weather,"weather",1,"12ba191e2fec98ad"),twitter:this.wrapWidget(Twitter,"twitter",2,""),stock:this.wrapWidget(Stock,"stock",2,"")}},a.getSidenavButtons=function(){var a;return a=_.values(Dashboard.Widgets.Manager.wrappers),_.map(a,function(a){return a.widgetLogo()})},a.getActiveWidgetsData=function(){var a;return a=this.getActiveWidgets(),_.map(a,this.getContainerAndNameOf)},a.getActiveWidgets=function(){return _.filter(Dashboard.Widgets.Manager.wrappers,function(a){return a.isActive})},a.getContainerAndNameOf=function(a){return{container:a.containerName,name:a.name}},a.hideActiveForms=function(){var a;return a=this.getActiveWidgets(),_.each(a,function(a){return a.hideWidgetForm()})},a.showActiveForms=function(){var a;return a=this.getActiveWidgets(),_.each(a,function(a){return a.showWidgetForm()})},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.Wrapper=function(){function a(a){this.widget=a.widget,this.widgetApiKey=a.apiKey,this.name=a.name,this.numberOfSlots=a.numberOfSlots}var b;return b="50",a.prototype.isActive=!1,a.prototype.setupWidgetIn=function(a){return this.containerName=a.containerName,this.containerColumn=a.containerColumn,this.isActive=!0,this.widget.Controller.setupWidgetIn(this.containerName,this.widgetApiKey)},a.prototype.widgetLogo=function(){var a,c;return c=""+this.name+"-widget",a=this.widget.Display.generateLogo({dataId:c,width:b}),{html:a,isActive:this.isActive}},a.prototype.deactivateWidget=function(){return $(this.containerName).remove(),this.isActive=!1},a.prototype.addClosingButtonToContainer=function(){var a;return a=""+this.name+"-closing-button",$(this.containerName).prepend("<button data-id='"+a+"'>X</button>")},a.prototype.hideWidgetForm=function(){return this.widget.Display.hideForm()},a.prototype.showWidgetForm=function(){return this.widget.Display.showForm()},a}()}.call(this);