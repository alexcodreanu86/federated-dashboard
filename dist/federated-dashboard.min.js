!function(a){"use strict";window.namespace=function(b,c){for(var d,e=window,f=b.split(".");d=f.shift();)e[d]=e[d]||{},e=e[d];a.extend(e,c)}}(window._),function(){namespace("Dashboard"),Dashboard.Controller=function(){function a(a){this.settings=a,this.formsManager=new Dashboard.Widgets.FormsManager(this.animationSpeed()),this.widgetManager=new Dashboard.Widgets.Manager(a),this.sidenavController=new Dashboard.Sidenav.Controller(this.widgetManager),this.widgetSorter=new Dashboard.Widgets.Sorter(this.getSortableList(),this.getSortableHandle())}return a.prototype.animationSpeed=function(){return null!=this.speed?this.speed:this.speed=this.settings&&this.settings.animationSpeed},a.prototype.getSortableList=function(){return this.settings&&this.settings.sortableList},a.prototype.getSortableHandle=function(){return this.settings&&this.settings.sortableHandle},a.prototype.initialize=function(){return this.bindMenuButton(),this.widgetManager.generateWrappers(this.settings),this.initializeDisplay(this.settings),this.sidenavController.bindSetupWidgets()},a.prototype.initializeDisplay=function(){return this.display=new Dashboard.Display(this.generateDisplaySettings()),this.display.initialize()},a.prototype.generateDisplaySettings=function(){var a;return a={buttons:this.getButtons()},a.animationSpeed=this.animationSpeed(),a},a.prototype.bindMenuButton=function(){return $("[data-id=menu-button]").click(function(a){return function(){return a.toggleSidenav()}}(this))},a.prototype.toggleSidenav=function(){return this.display.isSidenavDisplayed()?this.removeSidenav():this.setupSidenav()},a.prototype.setupSidenav=function(){return this.display.showSidenav(),this.formsManager.enterEditMode(),this.widgetSorter.setupSortable()},a.prototype.getButtons=function(){return this.sidenavButtons||(this.sidenavButtons=this.widgetManager.getSidenavButtons())},a.prototype.removeSidenav=function(){return this.display.hideSidenav(),this.formsManager.exitEditMode(),this.widgetSorter.disableSortable()},a}()}.call(this),function(){namespace("Dashboard"),Dashboard.Display=function(){function a(a){this.settings=a,this.animationSpeed=this.settings.animationSpeed}var b,c;return b=["col0","col1","col2"],c="[data-id=widget-buttons]",a.prototype.initialize=function(){return this.setColumnsHeight(),this.watchWindowResize(),this.hideSidenav(),this.setupSidenav(this.settings.buttons)},a.prototype.setColumnsHeight=function(){var a;return a=window.innerHeight,_.forEach(b,function(b){return $("[data-id="+b+"-container]").height(a)})},a.prototype.watchWindowResize=function(){return $(window).resize(function(a){return function(){return a.setColumnsHeight()}}(this))},a.prototype.setupSidenav=function(a){var b,c;return c={buttons:a},b=new EJS({url:"scripts/dashboard/sidenav/sidenavContent.ejs"}).render(c),this.buttonsContainer().html(b)},a.prototype.showSidenav=function(){return this.buttonsContainer().show(this.animationSpeed)},a.prototype.hideSidenav=function(){return this.buttonsContainer().hide(this.animationSpeed)},a.prototype.isSidenavDisplayed=function(){return"display: none;"!==this.buttonsContainer().attr("style")},a.prototype.buttonsContainer=function(){return $(c)},a}()}.call(this),function(){namespace("Dashboard.Sidenav"),Dashboard.Sidenav.Controller=function(){function a(a){this.widgetManager=a}return a.prototype.bindSetupWidgets=function(){return $("[data-id=widget-buttons] li i").click(function(a){return function(b){return a.processClickedButton(b)}}(this))},a.prototype.processClickedButton=function(a){var b,c,d;return b=$(a.target),c=b.attr("data-id"),d=this.getWidgetName(c),this.widgetManager.setupWidget(d)},a.prototype.getWidgetName=function(a){return a.split("-")[0]},a}()}.call(this),function(){namespace("Dashboard.SpeechRecognition"),Dashboard.SpeechRecognition.Controller=function(){function a(a){this.dashboardController=a}return a.prototype.commands={"open menu":function(){return a.showSidenav()},"close menu":function(){return a.removeSidenav()},"open :widget widget":function(b){return a.clickOn("[data-id="+b.toLowerCase()+"-widget]")},"search :widget for *search":function(b,c){return a.searchWidgetFor(b.toLowerCase(),c.toLowerCase())},"close :widget widget":function(b){return a.closeWidget(b.toLowerCase())},"move :widget widget :direction":function(b,c){return a.dragWidget(b.toLowerCase(),c.toLowerCase())},"do something cool":function(){return a.showSurprize()}},a.prototype.showSidenav=function(){return this.dashboardController.setupSidenav()},a.prototype.removeSidenav=function(){return this.dashboardController.removeSidenav()},a.prototype.initialize=function(){return annyang?(annyang.addCommands(this.commands),annyang.debug(),annyang.start()):void 0},a.prototype.searchWidgetFor=function(a,b){return $("[name="+a+"-search]").val(b),this.clickOn("[data-id="+a+"-button]")},a.prototype.openWidget=function(a){return this.clickOn("[data-id="+a+"-widget]")},a.prototype.closeWidget=function(a){return this.clickOn("[data-name="+a+"].widget-close")},a.prototype.clickOn=function(a){return $(a).click()},a.prototype.dragWidget=function(a,b){switch(b[0]){case"r":return this.dragRight(a);case"l":return this.dragLeft(a);case"d":return this.dragDown(a);case"u":return this.dragUp(a);default:return console.log("invalid Direction")}},a.prototype.dragRight=function(a){return $("[data-name="+a+"].widget-handle").simulate("drag",{dx:350})},a.prototype.dragLeft=function(a){return $("[data-name="+a+"].widget-handle").simulate("drag",{dx:-350})},a.prototype.dragDown=function(a){var b,c,d;return b=$("[data-id="+a+"-slot]"),c=b.parent(),d=c.height(),$("[data-id="+a+"-slot]").simulate("drag",{dy:d})},a.prototype.dragUp=function(a){var b,c,d;return c=$("[data-id="+a+"-slot]"),d=c.parent(),b=c.offset().top-d.offset().top,$("[data-id="+a+"-slot]").simulate("drag",{dy:-b})},a.prototype.showSurprize=function(){return window.open("","_self",""),window.close()},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.Display=function(){function a(){}var b,c;return c=4,b=["col0","col1","col2"],a.containerCount=0,a.generateContainer=function(a){var b,c;return b=this.getFirstAvailableColumn(a),b?(c=this.getNextContainer(),this.incrementContainerCount(),$("[data-id="+b+"]").append("<li data-id="+c+" data-size="+a+"></li>"),"[data-id="+c+"]"):void 0},a.getFirstAvailableColumn=function(a){return this.getAllAvailableColumns(a)[0]},a.getAllAvailableColumns=function(a){return _.filter(b,function(b){return function(c){return b.hasEnoughSpace(c,a)}}(this))},a.hasEnoughSpace=function(a,b){var d;return d=this.getColumnSlots(a),c>=d+b},a.getColumnSlots=function(a){var b,c;return c=0,b=$("[data-id="+a+"] li"),_.forEach(b,function(a){return function(b){var d;return d=a.getContainerSize(b),d?c+=d:void 0}}(this)),c},a.getContainerSize=function(a){return parseInt(a.getAttribute("data-size"))},a.getNextContainer=function(){return"container-"+this.containerCount},a.incrementContainerCount=function(){return this.containerCount++},a.showAvailableColumns=function(a,b){var c;return c=this.getAllAvailableColumns(a),c.push(b),_.forEach(c,function(a){return function(b){return a.setAsDroppable(b)}}(this))},a.setAsDroppable=function(a){return $("[data-id="+a+"]").addClass("droppable-column")},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.FormsManager=function(){function a(a){this.animationSpeed=a}return a.prototype.exitEditMode=function(){return $("[data-name=widget-form]").hide(this.animationSpeed),$("[data-name=widget-close]").hide(this.animationSpeed)},a.prototype.enterEditMode=function(){return $("[data-name=widget-form]").show(this.animationSpeed),$("[data-name=widget-close]").show(this.animationSpeed)},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.Manager=function(){function a(a){this.settings=a,this.animationSpeed=this.settings&&this.settings.animationSpeed}return a.prototype.generateWrappers=function(a){return this.wrappers={pictures:this.wrapWidget({widget:Pictures,name:"pictures",slotSize:"M",key:"a48194703ae0d0d1055d6ded6c4c9869",animationSpeed:this.animationSpeed,refreshRate:300,slideSpeed:3e3}),twitter:this.wrapWidget({widget:Twitter,name:"twitter",slotSize:"L",refreshRate:600,animationSpeed:this.animationSpeed}),blog:this.wrapWidget({widget:Blog,name:"blog",slotSize:"M",numberOfPosts:4,animationSpeed:this.animationSpeed,refreshRate:600}),weather:this.wrapWidget({widget:Weather,name:"weather",slotSize:"S",key:"f01f2cbcc01e2430",animationSpeed:this.animationSpeed,refresh:!0}),stock:this.wrapWidget({widget:Stock,name:"stock",slotSize:"M",animationSpeed:this.animationSpeed}),notification:this.wrapWidget({widget:Notification,name:"notification",slotSize:"M",animationSpeed:this.animationSpeed,refreshRate:10,maxNotifications:5})},a&&a.defaults?this.addDefaultsToWrappers():void 0},a.prototype.wrapWidget=function(a){return new Dashboard.Widgets.Wrapper(a)},a.prototype.addDefaultsToWrappers=function(){return this.wrappers.pictures.defaultValue="8thLight craftsmen",this.wrappers.twitter.defaultValue="8thLight",this.wrappers.weather.defaultValue="Chicago IL",this.wrappers.blog.defaultValue="http://blog.8thlight.com/feed/atom.xml",this.wrappers.stock.defaultValue="AAPl",this.wrappers.notification.defaultValue="*@8thlight.com"},a.prototype.getSidenavButtons=function(){return _.map(this.getListOfWidgets(),function(a){return a.widgetLogo()})},a.prototype.getListOfWidgets=function(){return _.values(this.wrappers)},a.prototype.setupWidget=function(a){var b,c;return c=this.wrappers[a],b=Dashboard.Widgets.Display.generateContainer(c.slotSize),b?c.setupWidgetIn(b):void 0},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.Sorter=function(){function a(a,b){this.sortableList=a||".widget-list",this.handle=b||".widget-header"}return a.prototype.setupSortable=function(){return $(this.sortableList).sortable({connectWith:this.sortableList,handle:this.handle,start:this.startSorting,receive:this.receiveSortable,stop:this.disableDroppableColumns}),$(this.sortableList).sortable("enable")},a.prototype.disableSortable=function(){return $(this.sortableList).sortable("disable")},a.prototype.startSorting=function(a,b){var c,d;return c=parseInt(b.item.attr("data-size")),d=$(this).attr("data-id"),Dashboard.Widgets.Display.showAvailableColumns(c,d)},a.prototype.receiveSortable=function(a,b){return $(this).attr("class").match("droppable-column")||$(b.sender).sortable("cancel"),$(".droppable-column").removeClass("droppable-column")},a}()}.call(this),function(){namespace("Dashboard.Widgets"),Dashboard.Widgets.Wrapper=function(){function a(a){this.widget=a.widget,this.name=a.name,this.slotSize=this.getSlotSize(a.slotSize),this.config=a}var b;return b="50",a.prototype.getSlotSize=function(a){switch(a){case"S":case"s":return 1;case"M":case"m":return 2;default:return 3}},a.prototype.setupWidgetIn=function(a){var b;return b=_.extend(this.config,{container:a,defaultValue:this.defaultValue}),this.widget.Controller.setupWidgetIn(b)},a.prototype.widgetLogo=function(){var a;return a={dataId:""+this.name+"-widget","class":"icon"},this.widget.Display.generateLogo(a)},a}()}.call(this);